%% LHS simulation
clear all
clc

%% Check for reconstruction of the variable
type = 'magnifying';
S   = 50;
M   = 3;
a_l = -1;
a_u =  1;
% Create object
obj = subsampling( type , S , M , a_l , a_u );
% Create boundaries
c_s = create_boundaries( obj );
%% DGP and discretization
rng( 100 );
N  = 1000;
MC = 1000;
pd1 = makedist( 'Normal' , 'sigma' , 2 );
t1  = truncate( pd1 , -1 , 1 );
X   = random( t1 , N , 1 );
pd2 = makedist( 'Normal' );
t2  = truncate( pd2 , -1 , 1 );
eps = random( t2 , N , MC );
Y = 0.5 * repmat( X , [ 1 , MC ] ) + eps;
artY = NaN( size( Y ) );
%% Estimation for each MC-sample
b = NaN( MC , 2 );
XX = [ ones( N , 1 ) , X ];
for mc = 1 : MC
    Y_s = discretize_rv( obj , Y( : , mc ) );
    % Create artificial distribution
    artY_1 = create_artificial_distribution( obj , Y_s );
    artY( : , mc ) = artY_1( 1 : N );
    % Create the working sample
    Y_ws = create_working_sample( obj, Y_s , artY_1 );
    %% Estimation
    b( mc , : ) = lscov( XX , Y_ws );
end
disp( mean( 0.5 - b( : , 2 ) ) )


